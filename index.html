<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>dikoora - AI Room Design & Furniture Shop</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica', 'Arial', sans-serif;
            background: #0a0e27;
            color: white;
            overflow-x: hidden;
        }

        /* Navigation */
        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 24px 100px;
            background: #0a0e27;
            position: relative;
            z-index: 100;
        }

        .logo {
            font-size: 26px;
            font-weight: 800;
            color: white;
            letter-spacing: -0.5px;
        }

        .nav-links {
            display: flex;
            gap: 48px;
            list-style: none;
        }

        .nav-links a {
            color: rgba(255, 255, 255, 0.85);
            text-decoration: none;
            font-size: 16px;
            font-weight: 500;
            transition: color 0.2s;
        }

        .nav-links a:hover {
            color: white;
        }

        .nav-buttons {
            display: flex;
            gap: 12px;
        }

        .btn-login {
            padding: 12px 32px;
            border: 1.5px solid rgba(255, 255, 255, 0.3);
            background: transparent;
            color: white;
            border-radius: 10px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            transition: all 0.2s;
        }

        .btn-login:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.5);
        }

        .btn-signup {
            padding: 12px 32px;
            border: none;
            background: linear-gradient(135deg, #1e3a8a 0%, #0a0e27 100%);
            color: white;
            border-radius: 10px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            transition: all 0.2s;
        }

        .btn-signup:hover {
            background: linear-gradient(135deg, #1e40af 0%, #0f1629 100%);
            transform: translateY(-1px);
        }

        /* Hero Section */
        .hero {
            display: grid;
            grid-template-columns: 1fr 1.1fr;
            gap: 80px;
            padding: 100px 100px 80px 100px;
            align-items: center;
            max-width: 1600px;
            margin: 0 auto;
            position: relative;
            min-height: 700px;
        }

        .hero.design-active {
            display: grid;
            grid-template-columns: 1fr;
            align-items: flex-start;
            padding: 30px 40px 60px 40px;
            gap: 36px;
            min-height: auto;
        }

        .hero-content {
            max-width: 600px;
            transition: opacity 0.5s ease-out;
        }

        .hero.design-active .hero-content {
            opacity: 0;
            pointer-events: none;
            visibility: hidden;
            display: none;
        }

        .badge {
            display: inline-block;
            padding: 6px 14px;
            background: rgba(139, 195, 74, 0.15);
            border: 1px solid rgba(139, 195, 74, 0.4);
            border-radius: 6px;
            color: #8BC34A;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 32px;
            letter-spacing: 0.3px;
        }

        h1 {
            font-size: 72px;
            font-weight: 800;
            line-height: 1.05;
            margin-bottom: 24px;
            letter-spacing: -2px;
        }

        .hero-description {
            font-size: 22px;
            color: rgba(255, 255, 255, 0.75);
            margin-bottom: 12px;
            line-height: 1.5;
            font-weight: 400;
        }

        .hero-description strong {
            color: white;
            font-weight: 600;
        }

        .btn-upload {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 20px 48px;
            background: linear-gradient(135deg, #1e3a8a 0%, #0a0e27 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 17px;
            font-weight: 700;
            cursor: pointer;
            margin-top: 40px;
            transition: all 0.2s;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            box-shadow: 0 4px 14px rgba(30, 58, 138, 0.4);
        }

        .btn-upload:hover {
            background: linear-gradient(135deg, #1e40af 0%, #0f1629 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(30, 58, 138, 0.6);
        }

        .upload-icon {
            font-size: 20px;
        }

        .upload-note {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.5);
            margin-top: 16px;
            font-weight: 500;
        }

        /* Hero Image */
        .hero-image {
            position: relative;
            perspective: 1000px;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 500px;
        }

        .hero.design-active .hero-image {
            grid-column: 1 / -1;
            max-width: none;
            width: 100%;
        }

        .room-preview {
            width: 100%;
            border-radius: 16px;
            box-shadow: 0 25px 70px rgba(0, 0, 0, 0.6);
            display: block;
            transition: opacity 0.5s ease-out;
        }

        .hero.design-active .room-preview {
            opacity: 0;
            pointer-events: none;
            display: none;
        }

        .hero.design-active .dropdown-tag {
            display: none;
        }

        .dropdown-tag {
            position: absolute;
            background: white;
            padding: 14px 22px;
            border-radius: 10px;
            color: #0a0e27;
            font-weight: 600;
            font-size: 15px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.25);
            display: flex;
            align-items: center;
            gap: 8px;
            transition: opacity 0.5s ease-out;
        }

        .hero.design-active .dropdown-tag {
            opacity: 0;
            pointer-events: none;
        }

        .style-dropdown {
            bottom: 32px;
            left: 32px;
        }

        .category-dropdown {
            bottom: 32px;
            right: 32px;
        }

        /* Features */
        .features {
            display: flex;
            justify-content: center;
            gap: 64px;
            padding: 60px 100px;
            border-top: 1px solid rgba(255, 255, 255, 0.08);
            flex-wrap: wrap;
            max-width: 1600px;
            margin: 0 auto;
        }

        .feature {
            display: flex;
            align-items: center;
            gap: 12px;
            color: rgba(255, 255, 255, 0.75);
            font-size: 16px;
            font-weight: 500;
        }

        .checkmark {
            color: #8BC34A;
            font-size: 22px;
            font-weight: 700;
        }

        /* Testimonials */
        .testimonials {
            padding: 100px 100px 120px 100px;
            background: white;
            width: 100%;
        }

        .testimonial-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 24px;
            margin-top: 60px;
            max-width: 1600px;
            margin-left: auto;
            margin-right: auto;
        }

        .testimonial {
            background: #f5f7fa;
            padding: 36px;
            border-radius: 14px;
            border: 1px solid #e8ecef;
            transition: all 0.3s;
        }

        .testimonial:hover {
            background: #edf1f5;
            border-color: #d8dfe5;
            transform: translateY(-4px);
        }

        .quote-icon {
            font-size: 42px;
            color: #5B8DEF;
            margin-bottom: 18px;
            line-height: 1;
        }

        .testimonial-text {
            color: #1a1a1a;
            font-size: 16px;
            line-height: 1.65;
            margin-bottom: 24px;
            font-weight: 400;
        }

        .testimonial-author {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .author-logo {
            font-weight: 800;
            font-size: 17px;
            color: #1a1a1a;
            letter-spacing: -0.3px;
        }

        /* How It Works Section */
        .how-it-works {
            background: white;
            padding: 120px 100px;
            width: 100%;
        }

        .how-it-works-header {
            text-align: center;
            margin-bottom: 100px;
        }

        .how-it-works-header h2 {
            font-size: 48px;
            font-weight: 800;
            color: #1a1a1a;
            margin-bottom: 16px;
            letter-spacing: -1.5px;
        }

        .how-it-works-header p {
            font-size: 20px;
            color: #666;
            font-weight: 400;
        }

        .how-it-works-header p a {
            color: #5B8DEF;
            text-decoration: none;
            font-weight: 600;
        }

        .steps-container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .step {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 80px;
            align-items: center;
            margin-bottom: 120px;
        }

        .step:nth-child(even) {
            direction: rtl;
        }

        .step:nth-child(even) > * {
            direction: ltr;
        }

        .step-content {
            padding: 20px 0;
        }

        .step-label {
            font-size: 14px;
            font-weight: 700;
            color: #5B8DEF;
            margin-bottom: 16px;
            letter-spacing: 0.5px;
        }

        .step-content h3 {
            font-size: 40px;
            font-weight: 800;
            color: #1a1a1a;
            margin-bottom: 20px;
            letter-spacing: -1px;
            line-height: 1.2;
        }

        .step-content p {
            font-size: 18px;
            color: #666;
            line-height: 1.7;
            font-weight: 400;
        }

        .step-image {
            position: relative;
        }

        .step-image img {
            width: 100%;
            border-radius: 16px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.15);
        }

        .step-features {
            display: flex;
            gap: 24px;
            margin-top: 24px;
            flex-wrap: wrap;
        }

        .step-feature {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 15px;
            color: #1a1a1a;
            font-weight: 600;
        }

        .step-feature-icon {
            width: 24px;
            height: 24px;
            background: #5B8DEF;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
        }

        /* Customer Reviews Section */
        .customer-reviews {
            background: #f8f9fb;
            padding: 100px 100px;
            width: 100%;
        }

        .reviews-header {
            text-align: center;
            margin-bottom: 60px;
        }

        .reviews-header h2 {
            font-size: 48px;
            font-weight: 800;
            color: #1a1a1a;
            margin-bottom: 16px;
            letter-spacing: -1.5px;
        }

        .reviews-header p {
            font-size: 18px;
            color: #666;
            font-weight: 400;
        }

        .reviews-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 32px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .review-card {
            background: white;
            padding: 40px;
            border-radius: 16px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
        }

        .reviewer {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 20px;
        }

        .reviewer-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .reviewer-info h4 {
            font-size: 16px;
            font-weight: 700;
            color: #1a1a1a;
            margin-bottom: 4px;
        }

        .reviewer-info p {
            font-size: 14px;
            color: #666;
            font-weight: 500;
        }

        .review-text {
            font-size: 16px;
            color: #333;
            line-height: 1.7;
            font-weight: 400;
        }

        /* CTA Section */
        .cta-section {
            background: white;
            padding: 100px 100px;
            text-align: center;
            width: 100%;
        }

        .cta-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .cta-badge {
            display: inline-block;
            padding: 8px 16px;
            background: rgba(91, 141, 239, 0.1);
            border-radius: 20px;
            color: #5B8DEF;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 24px;
        }

        .cta-content h2 {
            font-size: 56px;
            font-weight: 800;
            color: #1a1a1a;
            margin-bottom: 24px;
            letter-spacing: -1.5px;
            line-height: 1.1;
        }

        .cta-content p {
            font-size: 20px;
            color: #666;
            margin-bottom: 40px;
            line-height: 1.6;
        }

        .btn-cta {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 20px 48px;
            background: #1a1e3d;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 17px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            box-shadow: 0 4px 14px rgba(26, 30, 61, 0.3);
        }

        .btn-cta:hover {
            background: #0f1229;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(26, 30, 61, 0.4);
        }

        .cta-rating {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-top: 32px;
        }

        .stars {
            color: #fbbf24;
            font-size: 20px;
            letter-spacing: 4px;
        }

        .rating-text {
            font-size: 16px;
            color: #999;
            font-weight: 600;
        }

        .cta-features {
            display: flex;
            justify-content: center;
            gap: 48px;
            margin-top: 48px;
        }

        .cta-feature {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 16px;
            color: #1a1a1a;
            font-weight: 600;
        }

        .cta-feature-icon {
            width: 24px;
            height: 24px;
            background: #1a1e3d;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
        }

        /* Footer */
        footer {
            background: #1a1e3d;
            color: white;
            padding: 60px 100px 40px 100px;
            width: 100%;
        }

        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            gap: 60px;
            margin-bottom: 40px;
        }

        .footer-brand h3 {
            font-size: 24px;
            font-weight: 800;
            margin-bottom: 16px;
        }

        .footer-social {
            display: flex;
            gap: 16px;
            margin-top: 20px;
        }

        .social-icon {
            width: 36px;
            height: 36px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            text-decoration: none;
            transition: background 0.2s;
        }

        .social-icon:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .footer-section h4 {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 20px;
            color: white;
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 12px;
        }

        .footer-links a {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            font-size: 15px;
            transition: color 0.2s;
        }

        .footer-links a:hover {
            color: white;
        }

        .footer-bottom {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 32px;
            text-align: center;
            color: rgba(255, 255, 255, 0.6);
            font-size: 14px;
        }

        /* Design Tool Styles */
        .hero-image.design-mode {
            display: flex;
            flex-direction: column;
            gap: 24px;
            max-width: 900px;
            margin: 0 auto;
            width: 100%;
            align-items: center;
        }

        .upload-area {
            border: 3px dashed #667eea;
            border-radius: 16px;
            padding: 60px 20px;
            text-align: center;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.95);
            opacity: 0;
            display: none;
            transition: opacity 0.6s ease-in;
        }

        .upload-area.active {
            display: block;
            opacity: 1;
        }

        .upload-area:hover {
            border-color: #764ba2;
            background: white;
            transform: translateY(-2px);
        }

        .upload-area.dragover {
            border-color: #764ba2;
            background: white;
        }

        .upload-area-icon {
            font-size: 4em;
            margin-bottom: 20px;
            color: #667eea;
        }

        .upload-area-text {
            color: #333;
            font-size: 1.2em;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .upload-area-subtext {
            color: #999;
            font-size: 0.9em;
        }

        input[type="file"] {
            display: none;
        }

        .preview-container {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            padding: 30px;
            opacity: 0;
            transition: opacity 0.6s ease-in;
            position: relative;
        }

        .preview-container.active {
            display: block;
            opacity: 1;
        }

        .image-preview {
            width: 100%;
            max-height: 600px;
            object-fit: contain;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .btn-design {
            background: linear-gradient(135deg, #1e3a8a 0%, #0a0e27 100%);
            color: white;
            border: none;
            padding: 16px 40px;
            border-radius: 12px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(30, 58, 138, 0.4);
            width: 100%;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }

        .btn-design:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(30, 58, 138, 0.6);
        }

        .btn-design:active {
            transform: translateY(0);
        }

        .btn-design:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 40px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            color: #667eea;
            font-size: 1.1em;
            font-weight: 600;
        }

        .result-container {
            display: none;
            position: relative;
            max-width: 1400px;
            width: 100%;
            margin: 0 auto;
            border-radius: 28px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.45), rgba(118, 75, 162, 0.55));
            padding: 1px;
            box-shadow: 0 32px 90px rgba(8, 13, 48, 0.45);
            opacity: 0;
            transition: opacity 0.6s ease-in;
            overflow: hidden;
        }

        .result-container.active {
            display: block;
            opacity: 1;
        }

        .result-surface {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 27px;
            padding: 40px 44px;
            position: relative;
        }

        .result-title {
            font-size: 1.75em;
            margin-bottom: 32px;
            text-align: center;
            font-weight: 800;
            letter-spacing: -0.4px;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .result-layout {
            display: grid;
            grid-template-columns: minmax(0, 72%) minmax(0, 28%);
            gap: 36px;
            align-items: stretch;
        }

        .result-image-wrapper {
            border-radius: 24px;
            padding: 14px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.25), rgba(118, 75, 162, 0.4));
            box-shadow: 0 26px 55px rgba(10, 14, 39, 0.35);
        }

        .result-image {
            width: 100%;
            height: 100%;
            max-height: 70vh;
            object-fit: cover;
            display: block;
            border-radius: 18px;
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.18);
        }

        .result-info {
            display: flex;
            flex-direction: column;
            gap: 28px;
            height: 100%;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.92);
            color: #1e3a8a;
            border: 2px solid rgba(30, 58, 138, 0.6);
            margin-top: 20px;
            padding: 16px 42px;
            border-radius: 14px;
            font-size: 1.05em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.26s ease;
            width: 100%;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            box-shadow: 0 10px 20px rgba(30, 58, 138, 0.18);
        }

        .btn-secondary:hover {
            background: linear-gradient(135deg, #1e3a8a 0%, #0a0e27 100%);
            color: #fff;
            border-color: transparent;
            transform: translateY(-2px);
            box-shadow: 0 16px 30px rgba(30, 58, 138, 0.35);
        }

        .result-info .btn-secondary {
            margin-top: auto;
        }

        .error-message {
            display: none;
            background: #fee;
            color: #c33;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
        }

        .error-message.active {
            display: block;
        }

        /* Furniture List Styles */
        .furniture-list {
            margin-top: 0;
            padding: 26px 26px 28px 26px;
            border-radius: 20px;
            border: 1px solid rgba(102, 126, 234, 0.18);
            background: rgba(247, 248, 255, 0.96);
            box-shadow: 0 16px 36px rgba(14, 21, 63, 0.18);
            flex: 1;
            overflow-y: auto;
            max-height: 66vh;
        }

        .furniture-list::-webkit-scrollbar {
            width: 8px;
        }

        .furniture-list::-webkit-scrollbar-thumb {
            background: rgba(102, 126, 234, 0.4);
            border-radius: 999px;
        }

        .furniture-list::-webkit-scrollbar-track {
            background: rgba(102, 126, 234, 0.08);
            border-radius: 999px;
        }

        .furniture-list-title {
            color: #1a1a1a;
            font-size: 1.4em;
            font-weight: 800;
            margin-bottom: 6px;
            text-align: left;
            letter-spacing: -0.4px;
        }

        .furniture-list-subtitle {
            text-align: left;
            color: rgba(15, 23, 61, 0.65);
            font-size: 0.9em;
            margin-bottom: 22px;
            font-weight: 600;
        }

        .furniture-items {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 16px;
            margin-bottom: 20px;
        }

        .furniture-item {
            background: white;
            border: 1px solid rgba(102, 126, 234, 0.18);
            border-radius: 14px;
            padding: 0;
            transition: all 0.25s ease;
            cursor: pointer;
            overflow: hidden;
            position: relative;
            box-shadow: 0 8px 18px rgba(14, 21, 63, 0.12);
        }

        .furniture-item:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 26px rgba(102, 126, 234, 0.22);
            border-color: rgba(102, 126, 234, 0.5);
        }

        .furniture-item-image-container {
            position: relative;
            width: 100%;
            height: 110px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.08), rgba(118, 75, 162, 0.12));
            overflow: hidden;
        }

        .furniture-item-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .furniture-item:hover .furniture-item-image {
            transform: scale(1.05);
        }

        .furniture-item-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(255, 255, 255, 0.92);
            padding: 4px 8px;
            border-radius: 999px;
            font-size: 0.7em;
            font-weight: 700;
            color: #4f5ddb;
            backdrop-filter: blur(12px);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.12);
        }

        .furniture-item-content {
            padding: 12px 14px 14px 14px;
        }

        .furniture-item-brand {
            font-size: 0.65em;
            color: rgba(102, 126, 234, 0.9);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            margin-bottom: 4px;
        }

        .furniture-item-name {
            font-size: 0.9em;
            font-weight: 700;
            color: #13183a;
            margin-bottom: 6px;
            line-height: 1.25;
            min-height: 2.4em;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .furniture-item-details {
            display: none;
        }

        .furniture-detail-tag {
            background: #f5f7fa;
            padding: 2px 5px;
            border-radius: 3px;
            font-size: 0.6em;
            color: #555;
            font-weight: 500;
            white-space: nowrap;
        }

        .furniture-item-price-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
        }

        .furniture-item-price {
            font-size: 0.95em;
            font-weight: 800;
            color: #667eea;
        }

        .furniture-item-rating {
            display: flex;
            align-items: center;
            gap: 1px;
            font-size: 0.6em;
            color: #fbbf24;
            font-weight: 600;
        }

        .btn-buy {
            background: linear-gradient(135deg, #1e3a8a 0%, #0a0e27 100%);
            color: white;
            border: none;
            padding: 8px 14px;
            border-radius: 8px;
            font-size: 0.78em;
            font-weight: 700;
            cursor: pointer;
            width: 100%;
            transition: all 0.25s ease;
            box-shadow: 0 6px 16px rgba(30, 58, 138, 0.35);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        .btn-buy:hover {
            background: linear-gradient(135deg, #1e40af 0%, #0f1629 100%);
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(30, 58, 138, 0.45);
        }

        .btn-buy:active {
            transform: translateY(0);
        }

        .total-price-banner {
            background: linear-gradient(135deg, #1e3a8a 0%, #0a0e27 100%);
            padding: 16px 20px;
            border-radius: 12px;
            text-align: center;
            color: white;
            margin-top: 12px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 12px;
            box-shadow: 0 12px 24px rgba(30, 58, 138, 0.35);
        }

        .total-price-label {
            font-size: 0.85em;
            opacity: 0.95;
            font-weight: 600;
        }

        .total-price-amount {
            font-size: 1.5em;
            font-weight: 800;
            letter-spacing: -0.6px;
        }

        @media (max-width: 768px) {
            .furniture-items {
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
                gap: 10px;
            }

            .furniture-item-image-container {
                height: 100px;
            }

            .furniture-item-content {
                padding: 8px;
            }

            .furniture-list-title {
                font-size: 1.1em;
            }

            .total-price-banner {
                flex-direction: column;
                gap: 4px;
                padding: 12px;
            }
        }

        @media (max-width: 1400px) {
            nav {
                padding: 24px 60px;
            }

            .hero {
                padding: 80px 60px;
                gap: 60px;
            }

            .result-surface {
                padding: 36px 38px;
            }

            .result-layout {
                grid-template-columns: minmax(0, 60%) minmax(0, 40%);
                gap: 30px;
            }

            .features {
                padding: 60px 60px;
            }

            .testimonials {
                padding: 80px 60px;
            }

            .how-it-works {
                padding: 100px 60px;
            }

            .step {
                gap: 60px;
                margin-bottom: 100px;
            }

            .customer-reviews {
                padding: 80px 60px;
            }

            .cta-section {
                padding: 80px 60px;
            }

            footer {
                padding: 50px 60px 30px 60px;
            }
        }

        @media (max-width: 1200px) {
            .hero {
                grid-template-columns: 1fr;
                padding: 60px 40px;
                gap: 60px;
            }

            h1 {
                font-size: 58px;
            }

            .testimonial-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            nav {
                padding: 20px 40px;
            }

            .features {
                padding: 50px 40px;
            }

            .testimonials {
                padding: 70px 40px;
            }

            .how-it-works {
                padding: 80px 40px;
            }

            .step {
                grid-template-columns: 1fr;
                gap: 40px;
                margin-bottom: 80px;
            }

            .step:nth-child(even) {
                direction: ltr;
            }

            .how-it-works-header h2 {
                font-size: 38px;
            }

            .step-content h3 {
                font-size: 32px;
            }

            .reviews-grid {
                grid-template-columns: 1fr;
            }

            .reviews-header h2 {
                font-size: 38px;
            }

            .cta-content h2 {
                font-size: 42px;
            }

            .cta-features {
                flex-direction: column;
                gap: 20px;
            }

            .footer-content {
                grid-template-columns: repeat(2, 1fr);
                gap: 40px;
            }
        }

        @media (max-width: 1100px) {
            .result-layout {
                grid-template-columns: 1fr;
                gap: 24px;
            }

            .result-image {
                max-height: 60vh;
            }

            .result-surface {
                padding: 32px 30px;
            }

            .furniture-list {
                max-height: none;
            }

            .result-info .btn-secondary {
                margin-top: 12px;
            }

            .furniture-items {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 44px;
                letter-spacing: -1.5px;
            }

            .hero-description {
                font-size: 18px;
            }

            .testimonial-grid {
                grid-template-columns: 1fr;
            }

            .features {
                flex-direction: column;
                gap: 24px;
                align-items: flex-start;
            }

            nav {
                padding: 20px;
            }

            .nav-links {
                display: none;
            }

            .hero {
                padding: 40px 20px;
            }

            .features {
                padding: 40px 20px;
            }

            .result-title {
                font-size: 1.4em;
            }

            .result-surface {
                padding: 28px 20px;
            }

            .furniture-items {
                grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            }

            .testimonials {
                padding: 60px 20px;
            }

            .how-it-works {
                padding: 60px 20px;
            }

            .how-it-works-header h2 {
                font-size: 32px;
            }

            .step-content h3 {
                font-size: 28px;
            }

            .step-content p {
                font-size: 16px;
            }

            .customer-reviews {
                padding: 60px 20px;
            }

            .reviews-header h2 {
                font-size: 32px;
            }

            .cta-section {
                padding: 60px 20px;
            }

            .cta-content h2 {
                font-size: 34px;
            }

            .cta-content p {
                font-size: 18px;
            }

            .cta-features {
                flex-direction: column;
                gap: 16px;
            }

            footer {
                padding: 40px 20px 30px 20px;
            }

            .footer-content {
                grid-template-columns: 1fr;
                gap: 32px;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav>
        <div class="logo">dikoora</div>
        <ul class="nav-links">
            <li><a href="#home">Home</a></li>
            <li><a href="#gallery">Gallery</a></li>
            <li><a href="#pricing">Pricing</a></li>
            <li><a href="#shop">Shop</a></li>
        </ul>
        <div class="nav-buttons">
            <button class="btn-login">Log in</button>
            <button class="btn-signup">Sign up</button>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <div class="badge">Powered by AI Technology</div>
            <h1>AI Room Design with one click</h1>
            <p class="hero-description">Upload a picture and our AI will <strong>design your room and show you where to buy the furniture.</strong></p>
            <button class="btn-upload" onclick="startDesign()">
                <span class="upload-icon">ðŸ“¸</span>
                Upload image for free
            </button>
            <p class="upload-note">No sign up | No credit card</p>
        </div>

        <div class="hero-image" id="heroImage">
            <img src="https://images.unsplash.com/photo-1616486338812-3dadae4b4ace?w=900&h=650&fit=crop&q=90" alt="Designed bedroom" class="room-preview" id="heroRoomPreview">
            <div class="dropdown-tag style-dropdown">
                Bedroom
                <span>â–¼</span>
            </div>
            <div class="dropdown-tag category-dropdown">
                Midcentury
                <span>â–¼</span>
            </div>

            <!-- Design Tool Interface (Hidden by default) -->
            <div class="error-message" id="errorMessage"></div>

            <div class="upload-area" id="uploadArea">
                <div class="upload-area-icon">&#128247;</div>
                <div class="upload-area-text">Click to upload or drag and drop</div>
                <div class="upload-area-subtext">Upload a photo of your empty room (PNG, JPG, JPEG)</div>
                <input type="file" id="fileInput" accept="image/*">
            </div>

            <div class="preview-container" id="previewContainer">
                <img id="imagePreview" class="image-preview" alt="Room preview">
                <button class="btn-design" id="designBtn">Design My Room</button>
            </div>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                <div class="loading-text">AI is designing your room...</div>
            </div>

            <div class="result-container" id="resultContainer">
                <div class="result-surface">
                    <h2 class="result-title">Your Designed Room</h2>
                    <div class="result-layout">
                        <div class="result-image-wrapper">
                            <img id="resultImage" class="result-image" alt="Designed room">
                        </div>

                        <div class="result-info">
                            <!-- Furniture List with Affiliate Links -->
                            <div class="furniture-list" id="furnitureList">
                                <h3 class="furniture-list-title">Shop the furniture in this design</h3>
                                <p class="furniture-list-subtitle">Click any item to purchase from our curated partners</p>
                                <div class="furniture-items" id="furnitureItems"></div>
                                <div class="total-price-banner" id="totalPriceBanner">
                                    <div class="total-price-label">Complete this look for</div>
                                    <div class="total-price-amount" id="totalPrice">$0.00</div>
                                </div>
                            </div>

                            <button class="btn-secondary" id="newDesignBtn">Design Another Room</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Features -->
    <section class="features">
        <div class="feature">
            <span class="checkmark">âœ“</span>
            <span>Low cost</span>
        </div>
        <div class="feature">
            <span class="checkmark">âœ“</span>
            <span>Instant results</span>
        </div>
        <div class="feature">
            <span class="checkmark">âœ“</span>
            <span>Furniture removal</span>
        </div>
        <div class="feature">
            <span class="checkmark">âœ“</span>
            <span>Multi-view staging</span>
        </div>
        <div class="feature">
            <span class="checkmark">âœ“</span>
            <span>10,000+ users</span>
        </div>
    </section>

    <!-- How It Works Section -->
    <section class="how-it-works">
        <div class="how-it-works-header">
            <h2>As low as $10.5 per image</h2>
            <p>AI room design with furniture shopping included. <a href="#how">Here's how it works â†“</a></p>
        </div>

        <div class="steps-container">
            <!-- Step 1 -->
            <div class="step">
                <div class="step-content">
                    <div class="step-label">Step 1</div>
                    <h3>Upload property images</h3>
                    <p>Drag and drop any image: 2D or 360Â°, vacant or with furniture, taken by any device.</p>
                </div>
                <div class="step-image">
                    <img src="https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?w=700&h=500&fit=crop" alt="Upload interface">
                </div>
            </div>

            <!-- Step 2 -->
            <div class="step">
                <div class="step-content">
                    <div class="step-label">Step 2</div>
                    <h3>AI designs your room</h3>
                    <p>Our AI will design your room with curated furniture pieces that match your style preferences.</p>
                </div>
                <div class="step-image">
                    <img src="https://images.unsplash.com/photo-1586023492125-27b2c045efd7?w=700&h=500&fit=crop" alt="Before and after room">
                </div>
            </div>

            <!-- Step 3 -->
            <div class="step">
                <div class="step-content">
                    <div class="step-label">Step 3</div>
                    <h3>Get photorealistic results</h3>
                    <p>Receive beautifully designed renders with furniture perfectly placed in your room within seconds.</p>
                    <div class="step-features">
                        <div class="step-feature">
                            <div class="step-feature-icon">âœ“</div>
                            <span>Ready in 10 Secs</span>
                        </div>
                        <div class="step-feature">
                            <div class="step-feature-icon">âœ“</div>
                            <span>Fully Customizable</span>
                        </div>
                        <div class="step-feature">
                            <div class="step-feature-icon">âœ“</div>
                            <span>Download as PSD</span>
                        </div>
                    </div>
                </div>
                <div class="step-image">
                    <img src="https://images.unsplash.com/photo-1600210492486-724fe5c67fb0?w=700&h=500&fit=crop" alt="Designed living room">
                </div>
            </div>

            <!-- Step 4 -->
            <div class="step">
                <div class="step-content">
                    <div class="step-label">Step 4</div>
                    <h3>Shop the furniture</h3>
                    <p>Click on any furniture piece in your designed room to purchase it directly from our curated marketplace.</p>
                </div>
                <div class="step-image">
                    <img src="https://images.unsplash.com/photo-1555041469-a586c61ea9bc?w=700&h=500&fit=crop" alt="Shopping interface">
                </div>
            </div>

            <!-- Step 5 -->
            <div class="step">
                <div class="step-content">
                    <div class="step-label">Step 5</div>
                    <h3>Save and share designs</h3>
                    <p>Save your favorite designs, share them with clients, or create multiple variations for the same space.</p>
                    <div class="step-features">
                        <div class="step-feature">
                            <div class="step-feature-icon">âœ“</div>
                            <span>Save Designs</span>
                        </div>
                        <div class="step-feature">
                            <div class="step-feature-icon">âœ“</div>
                            <span>Share with Clients</span>
                        </div>
                        <div class="step-feature">
                            <div class="step-feature-icon">âœ“</div>
                            <span>Multiple Variations</span>
                        </div>
                    </div>
                </div>
                <div class="step-image">
                    <img src="https://images.unsplash.com/photo-1618221195710-dd6b41faaea6?w=700&h=500&fit=crop" alt="Design variations">
                </div>
            </div>
        </div>
    </section>

    <!-- Customer Reviews -->
    <section class="customer-reviews">
        <div class="reviews-header">
            <h2>What customers say about us</h2>
            <p>Over 10,000 properties are designed with dikoora every month</p>
        </div>

        <div class="reviews-grid">
            <div class="review-card">
                <div class="reviewer">
                    <div class="reviewer-avatar"></div>
                    <div class="reviewer-info">
                        <h4>Aaron Horne,</h4>
                        <p>Real Estate Agency</p>
                    </div>
                </div>
                <p class="review-text">"Even those who are not design-savvy can easily create realistic and inviting virtually staged spaces that attract potential buyers regularly. It has taken our real estate marketing to the next level!"</p>
            </div>

            <div class="review-card">
                <div class="reviewer">
                    <div class="reviewer-avatar"></div>
                    <div class="reviewer-info">
                        <h4>Troy Sinclair,</h4>
                        <p>Real Estate Photographer</p>
                    </div>
                </div>
                <p class="review-text">"The lighting, shadows, and reflections are on point, making my workflow so much easier. My clients are amazed at the end results, bringing their homes to life and most importantly attracting potential buyers."</p>
            </div>

            <div class="review-card">
                <div class="reviewer">
                    <div class="reviewer-avatar"></div>
                    <div class="reviewer-info">
                        <h4>Nita Chyree,</h4>
                        <p>Interior Designer & Virtual Stager</p>
                    </div>
                </div>
                <p class="review-text">"dikoora is the best virtual staging software we've used. Their team acts as a partner to ensure we consistently produce stunning results that our clients are thrilled with."</p>
            </div>

            <div class="review-card">
                <div class="reviewer">
                    <div class="reviewer-avatar"></div>
                    <div class="reviewer-info">
                        <h4>Amy Lang,</h4>
                        <p>Home Stager</p>
                    </div>
                </div>
                <p class="review-text">"dikoora is a huge time and money saver! I'm able to deliver high-quality virtually staged images in record time, and my clients are beyond impressed with the custom style and quick turnaround."</p>
            </div>
        </div>
    </section>

    <!-- DIY Banner -->
    <section class="testimonials" style="padding: 60px 100px;">
        <div style="max-width: 1200px; margin: 0 auto; background: white; border-radius: 16px; padding: 32px 48px; box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08); display: flex; justify-content: space-between; align-items: center;">
            <div>
                <div style="font-size: 13px; color: #5B8DEF; font-weight: 600; margin-bottom: 8px;">Our budget option</div>
                <h3 style="font-size: 32px; font-weight: 800; color: #1a1a1a; margin-bottom: 8px;">DIY Room Design âœ¨</h3>
                <p style="font-size: 17px; color: #666;">Design stunning spaces with our drag-and-drop editor for just <strong style="color: #1a1a1a;">$7 per image</strong></p>
            </div>
            <button class="btn-cta" style="margin: 0;" onclick="window.location.href='index.html'">Try DIY design for free â†’</button>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="cta-section">
        <div class="cta-content">
            <div class="cta-badge">Our budget option</div>
            <h2>Transform your space with AI design today</h2>
            <p>Join thousands of professionals enhancing their properties with dikoora</p>
            <button class="btn-cta" onclick="window.location.href='index.html'">Try for free â†’</button>

            <div class="cta-rating">
                <div class="stars">â˜…â˜…â˜…â˜…â˜…</div>
                <span class="rating-text">4.8 out of 5</span>
            </div>

            <div class="cta-features">
                <div class="cta-feature">
                    <div class="cta-feature-icon">âœ“</div>
                    <span>Get started in minutes</span>
                </div>
                <div class="cta-feature">
                    <div class="cta-feature-icon">âœ“</div>
                    <span>100% satisfaction guarantee</span>
                </div>
                <div class="cta-feature">
                    <div class="cta-feature-icon">âœ“</div>
                    <span>24/7 premium support</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-brand">
                <h3>dikoora</h3>
                <div class="footer-social">
                    <a href="#" class="social-icon">in</a>
                    <a href="#" class="social-icon">f</a>
                    <a href="#" class="social-icon">ðŸ“·</a>
                </div>
                <p style="margin-top: 20px; color: rgba(255, 255, 255, 0.6); font-size: 14px;">Â© 2025 dikoora Inc.</p>
            </div>

            <div class="footer-section">
                <h4>Product</h4>
                <ul class="footer-links">
                    <li><a href="#pricing">Pricing</a></li>
                    <li><a href="#testimonials">Testimonials</a></li>
                    <li><a href="#gallery">Gallery</a></li>
                </ul>
            </div>

            <div class="footer-section">
                <h4>Resources</h4>
                <ul class="footer-links">
                    <li><a href="#help">Help Center</a></li>
                    <li><a href="#blog">Blog</a></li>
                </ul>
            </div>

            <div class="footer-section">
                <h4>Company</h4>
                <ul class="footer-links">
                    <li><a href="#contact">Contact Us</a></li>
                    <li><a href="#terms">Terms of Service</a></li>
                    <li><a href="#privacy">Privacy Policy</a></li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p>Made with â¤ï¸ for designers and real estate professionals</p>
        </div>
    </footer>

    <script>
        // Design Tool JavaScript
        const heroImage = document.getElementById('heroImage');
        const heroRoomPreview = document.getElementById('heroRoomPreview');
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const previewContainer = document.getElementById('previewContainer');
        const imagePreview = document.getElementById('imagePreview');
        const designBtn = document.getElementById('designBtn');
        const loading = document.getElementById('loading');
        const resultContainer = document.getElementById('resultContainer');
        const resultImage = document.getElementById('resultImage');
        const newDesignBtn = document.getElementById('newDesignBtn');
        const errorMessage = document.getElementById('errorMessage');

        let selectedFile = null;
        let selectedFurniture = []; // Store selected furniture with metadata

        // Start design mode
        function startDesign() {
            const heroSection = document.querySelector('.hero');

            // Fade out existing content
            heroSection.classList.add('design-active');

            // After fade out, show upload area
            setTimeout(() => {
                heroImage.classList.add('design-mode');
                uploadArea.classList.add('active');

                // Smooth scroll to design area
                heroSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 600);
        }

        // Upload area click
        uploadArea.addEventListener('click', () => {
            fileInput.click();
        });

        // Drag and drop
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        });

        // File input change
        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFile(e.target.files[0]);
            }
        });

        // Handle file selection
        function handleFile(file) {
            if (!file.type.startsWith('image/')) {
                showError('Please upload an image file');
                return;
            }

            selectedFile = file;
            const reader = new FileReader();
            reader.onload = (e) => {
                imagePreview.src = e.target.result;
                previewContainer.classList.add('active');
                uploadArea.classList.remove('active');
                hideError();
            };
            reader.readAsDataURL(file);
        }

        // Design button click
        designBtn.addEventListener('click', async () => {
            if (!selectedFile) return;

            designBtn.disabled = true;
            loading.classList.add('active');
            previewContainer.classList.remove('active');

            try {
                const base64Image = await fileToBase64(selectedFile);
                const designedImage = await generateDesign(base64Image);

                resultImage.src = designedImage;
                displayFurnitureList(); // Show furniture with affiliate links
                resultContainer.classList.add('active');
                loading.classList.remove('active');
            } catch (error) {
                console.error('Error:', error);
                showError('Failed to design room. Please try again.');
                loading.classList.remove('active');
                previewContainer.classList.add('active');
                designBtn.disabled = false;
            }
        });

        // New design button
        newDesignBtn.addEventListener('click', () => {
            resetUI();
        });

        // Convert file to base64 with compression
        function fileToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => {
                    const img = new Image();
                    img.onload = () => {
                        // Resize to max 1200px width for room image
                        const maxWidth = 1200;
                        let width = img.width;
                        let height = img.height;

                        if (width > maxWidth) {
                            height = (height * maxWidth) / width;
                            width = maxWidth;
                        }

                        const canvas = document.createElement('canvas');
                        canvas.width = width;
                        canvas.height = height;
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(img, 0, 0, width, height);

                        // Convert to base64 with quality 0.85
                        const base64 = canvas.toDataURL('image/jpeg', 0.85).split(',')[1];
                        resolve(base64);
                    };
                    img.src = reader.result;
                };
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }

        // Load furniture catalog from JSON
        async function loadFurnitureCatalog() {
            try {
                const response = await fetch('furniture-catalog.json');
                return await response.json();
            } catch (error) {
                console.error('Failed to load furniture catalog:', error);
                return null;
            }
        }

        // Load ONE random item from EACH category
        async function loadFurnitureImages() {
            const catalog = await loadFurnitureCatalog();
            if (!catalog) {
                throw new Error('Failed to load furniture catalog');
            }

            const furnitureImages = [];
            const furnitureNames = [];
            selectedFurniture = []; // Reset

            for (const [category, items] of Object.entries(catalog)) {
                if (items.length === 0) continue;

                // Pick random item from category
                const randomItem = items[Math.floor(Math.random() * items.length)];

                try {
                    const response = await fetch(randomItem.image);
                    const blob = await response.blob();
                    const base64 = await blobToBase64(blob);

                    furnitureImages.push({
                        mime_type: 'image/png',
                        data: base64
                    });
                    furnitureNames.push(category.slice(0, -1));
                    selectedFurniture.push(randomItem); // Store with metadata

                    console.log(`Selected ${category}:`, randomItem.name);
                } catch (error) {
                    console.error(`Failed to load ${randomItem.image}:`, error);
                }
            }

            console.log('Loaded furniture (1 per category):', furnitureNames.length, 'items');
            return { images: furnitureImages, names: furnitureNames };
        }

        // Convert blob to base64 with compression
        function blobToBase64(blob) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => {
                    const img = new Image();
                    img.onload = () => {
                        // Resize to max 800px width
                        const maxWidth = 800;
                        let width = img.width;
                        let height = img.height;

                        if (width > maxWidth) {
                            height = (height * maxWidth) / width;
                            width = maxWidth;
                        }

                        const canvas = document.createElement('canvas');
                        canvas.width = width;
                        canvas.height = height;
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(img, 0, 0, width, height);

                        // Convert to base64 with quality 0.8
                        const base64 = canvas.toDataURL('image/jpeg', 0.8).split(',')[1];
                        resolve(base64);
                    };
                    img.src = reader.result;
                };
                reader.onerror = reject;
                reader.readAsDataURL(blob);
            });
        }

        // Generate design using secure serverless function
        async function generateDesign(base64Image) {
            try {
                const furnitureData = await loadFurnitureImages();
                const furnitureImages = furnitureData.images.map(img => img.data);
                const furnitureNames = furnitureData.names;

                const endpoint = '/api/design';

                const response = await fetch(endpoint, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        roomImage: base64Image,
                        furnitureImages: furnitureImages,
                        furnitureNames: furnitureNames,
                        mimeType: selectedFile.type
                    })
                });

                const data = await response.json();
                console.log('API Response:', data);

                if (!response.ok) {
                    console.error('API Error:', data);
                    throw new Error(data.error || 'API request failed');
                }

                if (data.success && data.image) {
                    return data.image;
                }

                throw new Error('No image generated');

            } catch (error) {
                console.error('Generation Error:', error);
                throw error;
            }
        }

        // Reset UI
        function resetUI() {
            uploadArea.classList.add('active');
            previewContainer.classList.remove('active');
            resultContainer.classList.remove('active');
            loading.classList.remove('active');
            designBtn.disabled = false;
            selectedFile = null;
            fileInput.value = '';
            hideError();
        }

        // Display furniture list with affiliate links
        function displayFurnitureList() {
            const furnitureItemsContainer = document.getElementById('furnitureItems');
            furnitureItemsContainer.innerHTML = '';

            let totalPrice = 0;

            selectedFurniture.forEach(furniture => {
                totalPrice += furniture.price;

                const itemDiv = document.createElement('div');
                itemDiv.className = 'furniture-item';

                // Build detail tags
                let detailTags = '';
                if (furniture.style) {
                    detailTags += `<span class="furniture-detail-tag">${furniture.style}</span>`;
                }
                if (furniture.material) {
                    detailTags += `<span class="furniture-detail-tag">${furniture.material}</span>`;
                }
                if (furniture.colors && furniture.colors.length > 0) {
                    detailTags += `<span class="furniture-detail-tag">${furniture.colors[0]}</span>`;
                }

                // Build rating display
                const stars = 'â­'.repeat(Math.floor(furniture.rating || 0));
                const ratingDisplay = furniture.rating ?
                    `<div class="furniture-item-rating">${stars} ${furniture.rating}</div>` : '';

                // Build in-stock badge
                const stockBadge = furniture.inStock ?
                    `<div class="furniture-item-badge">âœ“ In Stock</div>` :
                    `<div class="furniture-item-badge" style="color: #ff6b6b;">Out of Stock</div>`;

                itemDiv.innerHTML = `
                    <div class="furniture-item-image-container">
                        <img src="${furniture.image}" alt="${furniture.name}" class="furniture-item-image">
                        ${stockBadge}
                    </div>
                    <div class="furniture-item-content">
                        <div class="furniture-item-brand">${furniture.brand || 'Brand'}</div>
                        <div class="furniture-item-name">${furniture.name}</div>
                        <div class="furniture-item-details">${detailTags}</div>
                        <div class="furniture-item-price-row">
                            <div class="furniture-item-price">$${furniture.price.toFixed(2)}</div>
                            ${ratingDisplay}
                        </div>
                        <button class="btn-buy" onclick="window.open('${furniture.affiliateLink}', '_blank')">
                            <span>Buy Now</span>
                            <span>â†’</span>
                        </button>
                    </div>
                `;

                furnitureItemsContainer.appendChild(itemDiv);
            });

            // Update total price
            document.getElementById('totalPrice').textContent = `$${totalPrice.toFixed(2)}`;
        }

        // Error handling
        function showError(message) {
            errorMessage.textContent = message;
            errorMessage.classList.add('active');
        }

        function hideError() {
            errorMessage.classList.remove('active');
        }
    </script>
</body>
</html>
